Contributed by Jack SimonsProfessor Emeritus and Henry Eyring Scientist Chemistry at University of Utah Trajectory PropagationForce FieldsCoarse GrainingContributors and Attributions One thing that the MC process does not address directly is the time evolution of the system That is the steps one examines in the MC algorithm are not straightforward to associate with a timeduration so it is not designed to compute the rates at which events take place If one is interested in simulating such dynamical processes even when the Nmolecule system is at or near equilibrium it is more appropriate to carry out a classical molecular dynamics MD simulation In such an MD calculation one has to assign initial values for each of the internal and external coordinates of each of the molecules and an initial value of the kinetic energy or momentum for each coordinate after which a timepropagation algorithm generates values for the coordinates and momenta at later times For example the initial coordinates could be chosen close to those of a local minimum on the energy surface and the initial momenta associated with each coordinate could be assigned values chosen from a MaxwellBoltzmann distribution characteristic of a specified temperature T In such cases it is common to then allow the MD trajectory to be propagated for a length of time long enough to allow further equilibration of the energy among all degrees of freedom before extracting any numerical data to use in evaluating average values or creating interparticle distance histograms for example One usually does not choose just one set of such initial coordinates and momenta to generate a single trajectory Rather one creates an ensemble of initial coordinates and momenta designed to represent the experimental conditions the MD calculation is to simulate The time evolution of the system for each set of initial conditions is then followed using MD and various outcomes eg reactive events barrier crossings folding or unfolding events chemisorption ocurrences etc are monitored throughout each MD simulation An average over the ensemble of trajectories is then used in computing averages and creating histograms for the MD simulation It is the purpose of this Section to describe how MD is used to follow the time evolution for such simulations Trajectory Propagation With each coordinate having its initial velocity and its initial value specified one then uses Newtons equations written for a time step of duration to propagate and forward in time according for example to the following firstorder propagation formula Here m_q is the mass factor connecting the velocity and the momentum pq conjugate to the coordinate q and is the force along the coordinate at the earlier geometry In most modern MD simulations more sophisticated numerical methods can be used to propagate the coordinates and momenta For example the widely used Verlet algorithm is derived as follows One expands the value of the coordinate at the and time steps in Taylor series in terms of values at the st time step One adds these two expansions to obtain which allows one to compute in terms of and and the force at the step while not requiring knowledge of velocities If the two Taylor expansions are subtracted one obtains as the expression for the velocity at the time step in terms of the coordinates at the and steps There are many other such propagation schemes that can be used in MD each has strengths and weaknesses In the present Section I will focus on describing the basic idea of how MD simulations are performed while leaving treatment of details about propagation schemes to more advanced sources such as Computer Simulations of Liquids M P Allen and D J Tildesley Oxford U Press New York The forces appearing in the MD propagation algorithms can be obtained as gradients of a BornOppenheimer electronic energy surface if this is computationally feasible Following this path involves performing what is called directdynamics MD Alternatively the forces can be computed from derivatives of an empirical force field In the latter case the systems potential energy is expressed in terms of analytical functions of intramolecular bond lengths bond angles and torsional angles as well as intermolecular distances and orientations The parameters appearing in such force fields have usually been determined from electronic structure calculations on molecular fragments spectroscopic determination of vibrational force constants and experimental measurements of intermolecular forces Force Fields Lets interrupt our discussion of MD propagation of coordinates and velocities to examine the ingredients that usually appear in the force fields mentioned above In Figure c we see a molecule in which various intramolecular and intermolecular interactions are introduced Figure c Depiction of a molecule in which bondstretching bondbending intramolecular van der Waals and intermolecular solvation potentials are illustrated The total potential of a system containing one or more such molecules in the presence of a solvent eg water it typically written as a sum of intramolecular potentials one for each molecule in the system and itermolecular potentials The former are usually decomposed into a sum of covalent interactions describing how the energy varies with bond stretching bond bending and dihedral angle distortion as depicted in Figure d Figure d Depiction of bond stretching and bending top left and dihedral angle distortion top right within a molecule and equations describing how the energy varies with these geometry changes and noncovalent interactions describing electrostatic and van der Waals interactions among the atoms in the molecule a These functional forms would be used to describe how the energy changes with the bond lengths and angles within for example each of the molecules shown in Figure c lets call them solute molecules as well as for any water molecules that may be present if these molecules are explicitly included in the MD simulation The interactions among the solute and solvent moleulues are also often expressed in a form involving electrostatic and van der Waals interations between pairs of atoms one on one molecule solute or solvent and the other on another molecule solute or solvent The Cartesian forces on any atom within a solute or solvent molecule are then computed for use in the MD simulation by using the chain rule to relate derivatives with respect to Cartesian coordinates to derivatives of the above intramolecular and intermolecular potentials with respect to the interatomic distances and the angles appearing in them Because water is such a ubiquitous component in condensedphase chemistry much effort has been devoted to generating highly accurate intermolecular potentials to describe the interactions among water molecules In the popular TIPP and TIPP models the waterwater interaction is given by where rOO is the distance between the oxygen atoms of the two water molecules in Å and indices and run over or sites respectively for TIPP or TIPP with labeling sites on one water molecule and labeling sites on the second water molecule The parameter is Å kcal mol A and B are conventional LennardJones parameters for oxygen atoms and qi is the magnitude of the partial charge on the ith site In Figure d we show how the or sites are defined for these two models Figure d Location of the or sites used in the TIPP and TIPP models Typical values for the parameters are given in the table below rOHÅ HOH angle degrees rOMÅ A Å kcalmol B Å kcalmol qOor qM qH TIPP x TIPP x In the TIPP model the three sites reside on the oxygen and two hydrogen centers For TIPP the fourth site is called the Msite and it resides off the oxygen center a distance of along the bisector of the two OH bonds as shown in Figure d In using either the TIPP or TIPP model the intramolecular bond lengths and angles are often constrained to remain fixed when doing so one is said to be using a rigid water model There are variants to these two site and site models that for example include van der Waals interactions between atoms on different water molecules and there are models including more than sites and models that allow for the polarization of each water molecule induced by the dipole fields as represented by the partial charges of the other water molecules and of solute molecules The more detail and complexity one introduces the more computational effort is needed to perform MD simulations In particular water molecules that allow for polarization are considerably more computationally demanding because they often involve solving selfconsistently for the polarization of each molecule by the charge and dipole potentials of all the other molecules with each dipole potential including both the permanent and induced dipoles of that molecule Professor John Wampler has created a web page in which the details about molecular mechanics force fields introduced above are summarized This web page provides links to numerous software packages that use these kinds of force fields to carry out MD simulations These links also offer more detailed information about the performance of various force fields as well as giving values for the parameters used in those force fields The parameter values are usually obtained by fitting the intramolecular or intermolecular functional form eg as shown above to energies obtained in electronic structure calculations at a large number of geometries or adjusting them to cause MD or MC simulations employing the force field to reproduce certain thermodynamic properties eg radial distribution functions solvation energies vaporization energies diffusion constants or some combination of both It is important to observe that the kind of force fields discussed above have limitations beyond issues of accuracy In particular they are not designed to allow for bond breaking and bond forming and they represent the BornOppenheimer energy of one most often the ground electronic state There are force fields explicitly designed to include chemical bonding changes but most MD packages do not include them When one is interested in treating a problem that involves transitions from one electronic state to another eg in spectroscopy or when the system undergoes a surface hop near a conical intersection it is most common to use a combined QMMM approach like we talked about in Section of Chapter A QM treatment of the portion of the system that undergoes the electronic transition is combined with a forcefield MM treatment of the rest of the system to carry out the MD simulation Lets now return to the issue of propagating trajectories given a force field and a set of initial conditions appropriate to describing the system to be simulated By applying one of the timepropagation algorithms to all of the coordinates and momenta of the molecules at time t one generates a set of new coordinates and new velocities appropriate to the system at time Using these new coordinates and momenta as and and evaluating the forces at these new coordinates one can again use the propagation equations to generate another finitetimestep set of new coordinates and velocities Through the sequential application of this process one generates a sequence of coordinates and velocities that simulate the systems behavior By following these coordinates and momenta one can interrogate any dynamical properties that one is interested in For example one could monitor oxygenoxygen distances throughout an MD simulation of liquid water with initial conditions chosen to represent water at a given temperature T would determine the initial momenta to generate a histogram of OO distances This would allow one to construct the kind of radial distribution function shown in Figure using MD simulation rather than MC The radial distribution function obtained in such an MD simulation should be identical to that obtained from MC because statistical mechanics assumes the ensemble average MC is equal to the longtime average MD of any property for a system at equilibrium Of course one could also monitor quantities that depend on time such as how often two oxygen atoms come within a certain distance throughout the MD simulation This kind of interrogation could not be achieved using MC because there is no sense of time in MC simulations In Chapter I again discuss using classical molecular dynamics to follow the time evolution of a chemical system However there is a fundamental difference between the kind of simulations described above and the case I treat in Chapter In the former one allows the Nmolecule system to reach equilibrium ie either by carefully choosing initial coordinates and momenta or by waiting until the dynamics has randomized the energy before monitoring the subsequent time evolution In the problem discussed in Chapter we use MD to follow the time progress of a system representing a single bimolecular collision in two crossed beams of molecules Each such beam contains molecules whose initial translational velocities are narrowly defined rather than MaxwellBoltzmann distributed In this case we do not allow the system to equilibrate because we are not trying to model an equilibrium system Instead we select an ensemble of initial conditions that represent the molecules in the two beams and we then follow the Newton dynamics to monitor the outcome eg reaction or nonreactive collision Unlike the MC method which is very amenable to parallel computation MD simulations are more difficult to carry out in a parallel manner One can certainly execute many different classical trajectories on many different computer nodes however to distribute one trajectory over many nodes is difficult The primary difficulty is that for each time step all of the molecules undergo moves to new coordinates and momenta To compute the forces on all molecules requires of the order of calculations eg when pairwise additive potentials are used In contrast each MC step requires that one evaluate the potential energy change accompanying the displacement of only one molecule This uses only of the order of computational steps again for pair wise additive potentials Another factor that complicates MD simulations has to do with the wide range of times scales that may be involved For example for one to use a time step dt short enough to follow highfrequency motions eg OH stretching in a simulation of an ion or polymer in water solvent dt must be of the order of s To then simulate the diffusion of an ion or the folding of a polymer in the liquid state which might require s or longer one would have to carry out MD steps This likely would render the simulation not feasible In the table below we illustrate the wide range of time scales that characterize various events that one might want to simulate using some form of MD and we give a sense of what is practical using MD simulations in the year Examples of dynamical processes taking place over timescales ranging from s through hundreds of seconds each of which one may wish to simulate using MD s s s s s s CH NH OH bond vibration Rotation of small molecule Routinely accessible time duration for atomistic MD simulation Time duration for heroic atomistic MD simulation Time duration achievable using coarsegraining techniquesa Time needed for protein folding a These techniques are discussed in Section Because one can not afford to carry out simulations covering s using time steps needed to follow bond vibrations s it is necessary to devise strategies to focus on motions whose time frame is of primary interest while ignoring or approximating faster motions For example when carrying out longtime MD simulations one can ignore the highfrequency intramolecular motions by simply not including these coordinates and momenta in the Netwonian dynamics eg as one does when using a rigidwater model discussed earlier In other words one simply freezes certain bond lengths and angles Of course this is an approximation whose consequences must be tested and justified and would certainly not be a wise step to take if those coordinates played a key role in the dynamical process being simulated Another approach called coarse graining involves replacing the fully atomistic description of selected components of the system by a muchsimplified description involving significantly fewer spatial coordinates and momenta Coarse Graining The goal of coarse graining is to bring the computational cost of a simulation into the realm of reality This is done by replacing the fully atomistic description of the system in which coordinates sufficient to specify the positions and in MD the velocities of every atom by a description in terms of fewer functional groups often referred to as beads The TIPP and TIPP models for the waterwater interaction potential discussed above are not coarsegrained models because they contain as many or more centers as atoms An example of a coarsegrained model for the waterwater interaction is provided by the StillingerWeber model that was originally introduced to treat tetrahedral Si of water introduced in V Molinero and E B Moore J Phys Chem B Here each water molecule is described only by the location of its oxygen nucleus labeled ri for the ith water molecule and the interaction potential is given as a sum of twobody and threebody terms where is the distance between the ith and jth oxygen atom deg and is the angle between the ith at the center jth and kth oxygen atom The parameters and are used to characterize various characteristics of the potential different values are needed to describe the behavior of Si Ge diamond or water even though they all can adopt tetrahedral coordination The form of the threebody part of this potential is designed to guide the orientations among oxygen atoms to adopt tetrahedral character Although the above potential seems more complicated than for example the form used in the TIPP or TIPP potential it has three important advantages when it comes to carrying out MD simulations Because the SW potential contains no terms varying with distance as ie no Coulomb interactions among partial charges it is of qualitatively shorter range than the other two potentials This allows spatial cutoffs to be used ie to ignore interactions beyond much shorter distances efficiently For a system containing water molecules the TIPP or TIPP models require one to evaluate functions of the distances between or centers whereas the SWs twobody component involves only interactions and the threebody component need only be evaluated for molecules and that are nearby molecule If for the atomistic models one wishes to treat the OH stretching and HOH bending motions MD time steps of ca s must be employed For the SW model the fastest motions involve relative movements of the oxygen centers which occur on time scales ca times longer This means that one can use longer MD steps The net result is that this coarsegrained model of the waterwater interaction allows MD simulations to be carried out for qualitatively longer time durations Of course this is only an advantage if the simulations provide accurate results In the Table shown below taken from the above reference we see MD simulation results as well as experimental results obtained with the above mW model with various TIPnP models and with two other popular waterwater potentials SPC and SPCE from which it is clear that the coarsegrained mW model is capable of yielding reliable results on a range of thermodynamic properties Figure e we see a coarsegrained representation of the DNA double helix taken from this reference as well as a depiction of how the beads are defined in terms of base sugar and phosphate units Figure e Depiction of cytosine base sugar and phosphate units constituting blue yellow and brown beads respectively a bead description of the double helix d locations of the beads relative to the atomic positions for the phosphate sugar and bases and definition of various beadbead interaction distances c In the Table shown below the reference cited above specifies the locations and masses of the phosphate sugar and base beads in the B form of the DNA helix The masses need to be chosen so that the coarsegrained dynamical motions of these units replicate within reasonable tolerances the center of mass motions of the phosphate sugar and base moieties when atomistic MD simulations are carried out on smaller test systems containing these nucleotide units The potential used to carry out the coarsegrained MD simulations is given by the equations shown below taken from the above reference In addition to the usual bond stretching bending and dihedral terms nb now the bonds relate to linkages between beads rather than between atoms that are similar to what we saw earlier in our discussion of force fields there are additional terms describes the interactions among pstacked base pairs describes the hydrogen bonding interactions between bases and describes excludedvolume effects where V_rm exsum_ijN_rm ex leftbeginarraycc varepsilonleftleftdfracsigma_ijr_ijrightleftdfracsigma_ijr_ijrightrightvarepsilon textif r_ijd_rm cut textif r_ijge d_rm cut endarrayright is the screened Coulombic interactions among phosphate units with its exponential decay constant given in terms of a socalled Debye screening length as detailed in the above reference The values of the parameters used in this force field potential given in the above reference are reproduced in the two Tables shown below Although there are numerous parameters in this potential the key to the success of this coarse graining is that there are only six kinds of sites whose positions and velocities must be propagated in the MD simulation phosphate sites sugar sites and four kinds of base sites This is far fewer coordinates that would arise in a fully atomistic MD simulation I will refer the reader to the reference cited above for details about how successful coarse graining was in this case but I will not go further into it at this time I think the two examples we discussed in this Section suffice for introducing the subject of coarse graining to the readers of this textIn summary for this Section MD classical simulations are not difficult to implement if one has available a proper representation of the intramolecular and intermolecular potential energy V Such calculations are routinely carried out on large biomolecules or condensedmedia systems containing thousands to millions of atomic centers There are however difficulties primarily connected to the time scales over which molecular motions and over which the process being simulated change that limit the success of this method and which often require one to employ reduced representations of the system such as in coarse graining In contrast quantum MD simulations such as we describe in the following Section are considerably more difficult to carry out Contributors and Attributions Jack Simons Henry Eyring Scientist and Professor of Chemistry U Utah Telluride Schools on Theoretical Chemistry Integrated by Tomoyuki Hayashi UC Davis